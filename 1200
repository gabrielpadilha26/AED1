#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct no {
    char v;
    struct no *esq, *dir;
} No;

No* insere(No* r, char v) {
    if (!r) {
        r = (No*)malloc(sizeof(No));
        r->v = v;
        r->esq = r->dir = NULL;
    } else if (v < r->v)
        r->esq = insere(r->esq, v);
    else
        r->dir = insere(r->dir, v);
    return r;
}

int busca(No* r, char v) {
    if (!r) return 0;
    if (r->v == v) return 1;
    if (v < r->v) return busca(r->esq, v);
    return busca(r->dir, v);
}

void infixa(No* r, int *first) {
    if (!r) return;
    infixa(r->esq, first);
    if (*first) { printf("%c", r->v); *first = 0; }
    else printf(" %c", r->v);
    infixa(r->dir, first);
}

void prefixa(No* r, int *first) {
    if (!r) return;
    if (*first) { printf("%c", r->v); *first = 0; }
    else printf(" %c", r->v);
    prefixa(r->esq, first);
    prefixa(r->dir, first);
}

void posfixa(No* r, int *first) {
    if (!r) return;
    posfixa(r->esq, first);
    posfixa(r->dir, first);
    if (*first) { printf("%c", r->v); *first = 0; }
    else printf(" %c", r->v);
}

int main() {
    No* raiz = NULL;
    char op[20], x;

    while (scanf("%s", op) != EOF) {
        if (strcmp(op, "I") == 0) {
            scanf(" %c", &x);
            raiz = insere(raiz, x);
        } else if (strcmp(op, "P") == 0) {
            scanf(" %c", &x);
            if (busca(raiz, x)) printf("%c existe\n", x);
            else printf("%c nao existe\n", x);
        } else if (strcmp(op, "INFIXA") == 0) {
            int first = 1;
            infixa(raiz, &first);
            printf("\n");
        } else if (strcmp(op, "PREFIXA") == 0) {
            int first = 1;
            prefixa(raiz, &first);
            printf("\n");
        } else if (strcmp(op, "POSFIXA") == 0) {
            int first = 1;
            posfixa(raiz, &first);
            printf("\n");
        }
    }

    return 0;
}
